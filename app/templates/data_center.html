<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Center - UN17 SDG Platform</title>
    
    <!-- Material-UI CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom Dashboard CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/themes.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
    
    <!-- Apply theme immediately to prevent flash -->
    <script>
        (function() {
            const storedTheme = localStorage.getItem('theme');
            const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            const theme = storedTheme || systemTheme;
            
            if (theme === 'dark') {
                document.documentElement.classList.add('dark-theme');
            }
        })();
    </script>
</head>
<body>
    <!-- Main Layout with Components -->
    <div class="dashboard-container">
        {% set active_page = 'data-center' %}
        {% include 'components/sidebar.html' %}
        
        <!-- Main Content -->
        <div class="main-content">
            {% include 'components/topbar.html' %}
            
            <!-- Content Area -->
            <div class="content-area">
                <div class="page-header">
                    <div class="page-title">
                        <h1>Data Center</h1>
                        <p>Comprehensive sustainability analytics and real-time insights</p>
                    </div>
                    <div class="page-actions">
                        <button class="btn-secondary" id="refreshAllData">
                            <span class="material-icons">refresh</span>
                            Refresh All Data
                        </button>
                        <button class="btn-primary" id="exportData">
                            <span class="material-icons">download</span>
                            Export Data
                        </button>
                    </div>
                </div>

            <!-- Real-time Metrics Dashboard -->
            <div class="metrics-dashboard">
                <div class="dashboard-header">
                    <h2>Real-time Metrics</h2>
                    <div class="dashboard-controls">
                        <div class="time-range-selector">
                            <label>Time Range:</label>
                            <select id="timeRange">
                                <option value="7d">Last 7 days</option>
                                <option value="30d" selected>Last 30 days</option>
                                <option value="90d">Last 90 days</option>
                                <option value="1y">Last year</option>
                            </select>
                        </div>
                        <div class="view-toggle">
                            <button class="toggle-btn active" data-view="grid">
                                <span class="material-icons">grid_view</span>
                            </button>
                            <button class="toggle-btn" data-view="list">
                                <span class="material-icons">list</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="metrics-grid" id="metricsGrid">
                    <!-- Metrics will be populated by JavaScript -->
                </div>
            </div>

            <!-- Analytics Charts Section -->
            <div class="analytics-section">
                <div class="section-header">
                    <h2>Analytics & Trends</h2>
                    <div class="chart-controls">
                        <button class="btn-outline" id="toggleCharts">
                            <span class="material-icons">visibility</span>
                            Toggle Charts
                        </button>
                    </div>
                </div>

                <div class="charts-container" id="chartsContainer">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>Sustainability Score Trend</h3>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <span class="legend-color" style="background: var(--accent-red);"></span>
                                    <span>Current Score</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: var(--accent-blue);"></span>
                                    <span>Target Score</span>
                                </div>
                            </div>
                        </div>
                        <div class="chart-content">
                            <canvas id="sustainabilityChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>Category Performance</h3>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <span class="legend-color" style="background: var(--accent-green);"></span>
                                    <span>Environmental</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: var(--accent-blue);"></span>
                                    <span>Social</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: var(--accent-red);"></span>
                                    <span>Economic</span>
                                </div>
                            </div>
                        </div>
                        <div class="chart-content">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>Carbon Footprint Analysis</h3>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #4CAF50;"></span>
                                    <span>Electricity</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #2196F3;"></span>
                                    <span>Transportation</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #FF9800;"></span>
                                    <span>Other Sources</span>
                                </div>
                            </div>
                        </div>
                        <div class="chart-content">
                            <canvas id="carbonChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>SDG Progress Tracking</h3>
                            <div class="chart-legend">
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #E91E63;"></span>
                                    <span>Primary Goals</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color" style="background: #9C27B0;"></span>
                                    <span>Secondary Goals</span>
                                </div>
                            </div>
                        </div>
                        <div class="chart-content">
                            <canvas id="sdgChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Insights Section -->
            <div class="ai-insights-section">
                <div class="section-header">
                    <h2>AI-Powered Insights</h2>
                    <div class="insights-controls">
                        <button class="btn-outline" id="generateInsights">
                            <span class="material-icons">psychology</span>
                            Generate New Insights
                        </button>
                    </div>
                </div>

                <div class="insights-container" id="insightsContainer">
                    <!-- AI insights will be populated by JavaScript -->
                </div>
            </div>

            <!-- Data Export Section -->
            <div class="export-section">
                <div class="section-header">
                    <h2>Data Export & Reports</h2>
                    <p>Export your sustainability data in various formats</p>
                </div>

                <div class="export-options">
                    <div class="export-card">
                        <div class="export-icon">
                            <span class="material-icons">table_chart</span>
                        </div>
                        <div class="export-content">
                            <h3>Excel Report</h3>
                            <p>Comprehensive data export with charts and analysis</p>
                            <button class="btn-primary" onclick="exportData('excel')">
                                <span class="material-icons">download</span>
                                Download Excel
                            </button>
                        </div>
                    </div>

                    <div class="export-card">
                        <div class="export-icon">
                            <span class="material-icons">description</span>
                        </div>
                        <div class="export-content">
                            <h3>PDF Report</h3>
                            <p>Professional PDF report with visualizations</p>
                            <button class="btn-primary" onclick="exportData('pdf')">
                                <span class="material-icons">download</span>
                                Download PDF
                            </button>
                        </div>
                    </div>

                    <div class="export-card">
                        <div class="export-icon">
                            <span class="material-icons">code</span>
                        </div>
                        <div class="export-content">
                            <h3>JSON Data</h3>
                            <p>Raw data export for integration purposes</p>
                            <button class="btn-primary" onclick="exportData('json')">
                                <span class="material-icons">download</span>
                                Download JSON
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='js/data_center.js') }}"></script>
    <script src="{{ url_for('static', filename='js/theme-toggle.js') }}"></script>
    <script src="{{ url_for('static', filename='js/navigation.js') }}"></script>
    <script>
        // Set current date
        document.addEventListener('DOMContentLoaded', function() {
            const dateElement = document.querySelector('.date-text');
            if (dateElement) {
                const today = new Date();
                const options = { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                };
                dateElement.textContent = today.toLocaleDateString('en-US', options);
            }
        });
    </script>
</body>
</html>